# TFC核销逻辑

## 1. 核销逻辑
#### 1. TFC流水号核销
一些通道下载的银行流水信息包含该笔交易的TFC请求流水，对应会计记账流水可以保证有对应TFC流水号，可以通过TFC流水号关联这两笔记录，实际核对时通过TFC流水号，金额，借贷记方向，记录是否已核对标记更新银行流水记录和会计流水记录为已核对。
#### 2. 银行流水号核销（待优化）
主要针对招行999账户，银行流水包括清算款，招行闪付款，支付宝充值，银联充值等需要TFC记账的流水，通过在记账时传入银行流水号，确保银行流水通过此流水号与会计流水关联上，实现这几种银行流水类型的精确匹配。
#### 3. 姓名，金额，借贷记方向，笔数模糊匹配
部分渠道银行不提供TFC流水号，通过sql按照姓名，金额，借贷及方向，笔数分别对银行流水和会计流水做group by，得到ArrayList对象，这四个参数对的上表示可以核销，直接移除，剩下未移除的继续做金额，借贷方向，笔数模糊匹配。
#### 4. 金额，借贷记方向，笔数模糊匹配
移除第3步未核对的银行流水中姓名不为空的记录，然后汇总成金额，借贷记方向，笔数的ArrayList：
-

测试
再次做核对，核对完后，
## 2. 滚动核销逻辑
